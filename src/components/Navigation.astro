---

---

<header
  id="main-nav"
  class="fixed top-0 left-0 w-full z-50 transition-all duration-500 transform translate-y-0 py-6"
>
  <div class="relative max-w-[95%] mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between">
      <!-- Logo: ACHIEVE (No dot) -->
      <a href="/" class="relative z-50 group">
        <span class="text-2xl font-black font-nura text-white tracking-tight">
          ACHIEVE
        </span>
      </a>

      <div class="flex items-center gap-6">
        <!-- CTA Button: Hero Style, Smaller, Isolated Classes -->
        <a
          href="#contact"
          class="nav-cta nav-blob-btn relative overflow-hidden px-5 py-2 rounded-full border border-white/20 bg-white/5 text-white text-xs font-semibold uppercase tracking-wider hover:scale-105 transition-transform duration-300 font-nura"
        >
          Let's Talk
        </a>

        <!-- Hamburger Menu Button: Always Visible, Isolated Classes -->
        <button
          id="nav-menu-btn"
          class="relative z-50 w-8 h-8 flex flex-col justify-center items-end gap-1.5 group cursor-pointer"
          aria-label="Toggle menu"
        >
          <span
            class="w-8 h-0.5 bg-white transition-all duration-300 origin-center block"
          ></span>
          <span
            class="w-8 h-0.5 bg-white transition-all duration-300 origin-center block"
          ></span>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div
    id="nav-menu-overlay"
    class="fixed inset-0 bg-black z-40 flex flex-col justify-center items-center opacity-0 pointer-events-none transition-opacity duration-500"
  >
    <nav class="flex flex-col items-center gap-6">
      {
        ['Work', 'Services', 'About'].map((item) => (
          <a
            href={`/${item.toLowerCase()}`}
            class="text-4xl sm:text-5xl md:text-7xl font-black font-nura text-white hover:text-accent-orange transition-colors duration-300 transform translate-y-8 opacity-0 nav-menu-link"
          >
            {item}
          </a>
        ))
      }
    </nav>
  </div>
</header>

<style>
  /* Isolated Blob Button Effect */
  .nav-blob-btn {
    isolation: isolate;
  }

  /* Scoped global styles for dynamically created elements */
  .nav-blob-btn :global(.nav-work-blob) {
    position: absolute;
    top: 0;
    left: 0;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #ff4500; /* Accent Orange */
    transform: translate(-50%, -50%) scale(0);
    transition: transform 0.5s ease;
    z-index: -1;
    pointer-events: none;
  }

  .nav-blob-btn :global(.nav-work-expand) {
    transform: translate(-50%, -50%) scale(25);
  }

  .nav-blob-btn:hover {
    color: #fff !important;
    border-color: transparent;
  }

  /* Hamburger Animation */
  .nav-open #nav-menu-btn span:first-child {
    transform: translateY(4px) rotate(45deg);
  }

  .nav-open #nav-menu-btn span:last-child {
    transform: translateY(-4px) rotate(-45deg);
  }

  /* Color change when menu is open */
  .nav-open #nav-menu-btn span {
    background-color: #fff;
  }

  /* Menu Open State */
  .nav-open #nav-menu-overlay {
    opacity: 1;
    pointer-events: auto;
  }

  .nav-open .nav-menu-link {
    transform: translateY(0);
    opacity: 1;
    transition-delay: 0.1s;
  }
</style>

<script>
  import gsap from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';

  gsap.registerPlugin(ScrollTrigger);

  console.log('ðŸ§­ Isolated Navigation Initialized');

  // --- Isolated Blob Logic ---
  function initNavBlobButtons() {
    const btns = document.querySelectorAll('.nav-blob-btn');

    btns.forEach((btn) => {
      const element = btn as HTMLElement;

      element.addEventListener(
        'mouseenter',
        function (this: HTMLElement, e: MouseEvent) {
          // Cleaning up any existing blobs
          const existing = this.querySelector('.nav-work-blob');
          if (existing) existing.remove();

          const rect = this.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;

          const blob = document.createElement('div');
          blob.className = 'nav-work-blob';
          blob.style.left = x + 'px';
          blob.style.top = y + 'px';
          this.appendChild(blob);

          // Force reflow
          void blob.offsetWidth;

          setTimeout(() => {
            blob.classList.add('nav-work-expand');
          }, 10);
        }
      );

      element.addEventListener(
        'mouseleave',
        function (this: HTMLElement, e: MouseEvent) {
          const rect = this.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;

          const blobs = this.querySelectorAll('.nav-work-blob');
          blobs.forEach((blob) => {
            const el = blob as HTMLElement;
            el.style.left = x + 'px';
            el.style.top = y + 'px';
            el.classList.remove('nav-work-expand');
            setTimeout(() => {
              el.remove();
            }, 500);
          });
        }
      );
    });
  }

  initNavBlobButtons();

  // --- Smart Scroll Behavior ---
  let lastScroll = 0;
  const nav = document.getElementById('main-nav');
  const threshold = 50;

  window.addEventListener('scroll', () => {
    const currentScroll = window.pageYOffset;

    if (currentScroll <= 0) {
      nav?.classList.remove('-translate-y-full');
      return;
    }

    if (currentScroll > lastScroll && currentScroll > threshold) {
      // Scrolling Down - Hide
      nav?.classList.add('-translate-y-full');
    } else {
      // Scrolling Up - Show
      nav?.classList.remove('-translate-y-full');
    }

    lastScroll = currentScroll;
  });

  // --- Mobile Menu Logic ---
  const menuBtn = document.getElementById('nav-menu-btn');
  const body = document.body;

  menuBtn?.addEventListener('click', () => {
    body.classList.toggle('nav-open');
    if (body.classList.contains('nav-open')) {
      body.style.overflow = 'hidden';
      // Animate links in
      gsap.to('.nav-menu-link', {
        y: 0,
        opacity: 1,
        duration: 0.5,
        stagger: 0.1,
        ease: 'power3.out',
      });
    } else {
      body.style.overflow = '';
      // Reset links
      gsap.to('.nav-menu-link', {
        y: 30,
        opacity: 0,
        duration: 0.3,
      });
    }
  });
</script>

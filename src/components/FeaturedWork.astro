---
// Featured Work Section Component
const featuredProjects = [
  {
    id: 1,
    title: 'Digital Agency',
    slug: 'digital-agency',
    description: 'Modern agency website with immersive design',
    tags: ['Web Design', 'Development', 'Animation'],
  },
  {
    id: 2,
    title: 'E-Commerce Platform',
    slug: 'ecommerce-platform',
    description: 'Full-stack e-commerce solution with advanced features',
    tags: ['E-Commerce', 'Development'],
  },
  {
    id: 3,
    title: 'SaaS Dashboard',
    slug: 'saas-dashboard',
    description: 'Enterprise-grade dashboard with real-time analytics',
    tags: ['SaaS', 'UI/UX Design'],
  },
];
---

<section class="bg-[#F2F2F2] px-4 pt-24 pb-12 sm:px-6 lg:px-10 lg:pt-32" id="work-header">
  <div id="featured-work-header" class="mx-auto w-full lg:w-[85vw] xl:w-[80vw] 2xl:w-[75vw]">
    <div class="inline-block justify-start">
      <h2 class="text-4xl sm:text-5xl md:text-6xl font-black font-nura text-accent-orange mb-2 pt-8 pb-2" data-reveal="perspective" data-reveal-duration="0.8" data-reveal-delay="0.1">
        Featured Work
      </h2>
    </div>
    <p class="text-base sm:text-lg text-black/60 max-w-2xl md:text-xl lg:text-2xl pt-0" data-reveal="slide" data-reveal-duration="0.7" data-reveal-delay="0.2">
      Showcase of our latest projects and creative endeavors
    </p>
  </div>
</section>

<section id="featured-work-container" class="relative w-full h-[100svh] bg-[#0d141a] overflow-hidden">
  {featuredProjects.map((project, index) => (
    <article 
      class={`featured-card absolute inset-0 w-full h-full flex flex-col justify-end p-6 sm:p-12 lg:p-24 pb-20 lg:pb-32 will-change-transform ${index === 0 ? 'z-10' : 'z-20 transform translate-y-full'}`}
      style={`z-index: ${10 + index}; background-color: ${index % 2 === 0 ? '#111822' : '#0d141a'};`}
    >
      <!-- Background Asset (Video/Image Placeholder) -->
      <div class="absolute inset-0 w-full h-full overflow-hidden">
        <div class="absolute inset-0 opacity-20" style="background-image: linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 40px 40px;"></div>
        <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent z-10"></div>
        
        <!-- Center Play Button Mock -->
        <div class="absolute inset-0 flex items-center justify-center z-20">
          <div class="w-24 h-24 rounded-full bg-white/10 backdrop-blur-md flex items-center justify-center border border-white/20 text-white/50">
            <svg viewBox="0 0 24 24" fill="currentColor" class="w-12 h-12 ml-2">
              <path d="M8 5v14l11-7z"/>
            </svg>
          </div>
        </div>
      </div>

      <!-- Content -->
      <div class="relative z-30 w-full max-w-[90rem] mx-auto flex flex-col gap-6 lg:gap-8 xl:px-12">
        <div class="flex flex-wrap gap-3">
          {project.tags.map((tag) => (
            <span class="text-white/90 text-sm md:text-base border border-white/20 px-5 py-2 rounded-full backdrop-blur-md bg-white/5">
              {tag}
            </span>
          ))}
        </div>
        
        <div class="flex flex-col lg:flex-row lg:items-end justify-between gap-8">
          <h3 class="text-white text-5xl sm:text-6xl md:text-7xl lg:text-8xl xl:text-[7rem] font-nura uppercase leading-[0.9] tracking-tight max-w-4xl">
            {project.title}
          </h3>
          
          <a href={`/work/${project.slug}`} class="inline-flex items-center gap-6 text-white hover:text-accent-orange transition-colors group mb-2">
            <span class="text-lg md:text-xl font-bold uppercase tracking-widest">View Project</span>
            <div class="w-14 h-14 rounded-full border-2 border-white/30 flex items-center justify-center group-hover:border-accent-orange group-hover:bg-accent-orange/10 transition-all duration-300">
              <svg class="w-6 h-6 transform group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform duration-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M5 12h14M12 5l7 7-7 7"/>
              </svg>
            </div>
          </a>
        </div>
      </div>
    </article>
  ))}
</section>

<!-- View All Button below the pinned stack -->
<section class="w-full bg-[#0d141a] flex justify-center py-20 lg:py-32 relative z-[90]">
  <a href="/work" class="work-btn-view-all inline-flex items-center gap-4 px-10 py-5 rounded-full bg-white text-black font-bold uppercase tracking-wider hover:bg-accent-orange hover:text-white transition-all duration-300">
    <span>View All Projects</span>
    <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M5 12h14M12 5l7 7-7 7"/>
    </svg>
  </a>
</section>

<style>
  /* Local overrides for the wrapper */
  #featured-work-container {
    box-shadow: 0 -20px 50px rgba(0,0,0,0.1);
  }

  .work-btn-view-all {
    display: inline-block;
    position: relative;
    overflow: hidden;
  }

  :global(.work-blob-view-all) {
    z-index: 0;
    position: absolute;
    width: 2px;
    height: 2px;
    margin-left: 0;
    margin-top: 0;
    background: #ff4500;
    border-radius: 50%;
    transition: transform 0.45s ease-in-out;
    transform: scale(1);
  }

  :global(.work-expand-view-all) {
    transform: scale(300);
  }
  
  .work-btn-view-all span, .work-btn-view-all svg {
    position: relative;
    z-index: 10;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    initWorkButton();
  });

  document.addEventListener('astro:page-load', () => {
    initWorkButton();
  });

  function initWorkButton() {
    const btn = document.querySelector('.work-btn-view-all') as HTMLElement;
    if (!btn) return;

    btn.addEventListener('mouseenter', function(this: HTMLElement, e: MouseEvent) {
      const existing = this.querySelector('.work-blob-view-all');
      if (existing) existing.remove();

      const rect = this.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      const blob = document.createElement('div');
      blob.className = 'work-blob-view-all';
      blob.style.left = x + 'px';
      blob.style.top = y + 'px';
      this.appendChild(blob);
      
      setTimeout(function() {
        blob.classList.add('work-expand-view-all');
      }, 20);
    });

    btn.addEventListener('mouseleave', function(this: HTMLElement, e: MouseEvent) {
      const rect = this.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      const blobs = this.querySelectorAll('.work-blob-view-all');
      blobs.forEach(function(blob: Element) {
        const htmlBlob = blob as HTMLElement;
        htmlBlob.style.left = x + 'px';
        htmlBlob.style.top = y + 'px';
        blob.classList.remove('work-expand-view-all');
        setTimeout(function() {
          blob.remove();
        }, 450);
      });
    });
  }
</script>

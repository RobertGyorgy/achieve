---
// Featured Work Section Component
const featuredProjects = [
  {
    id: 1,
    title: 'Digital Agency',
    slug: 'digital-agency',
    description: 'Modern agency website with immersive design',
    tags: ['Web Design', 'Development', 'Animation'],
  },
  {
    id: 2,
    title: 'E-Commerce Platform',
    slug: 'ecommerce-platform',
    description: 'Full-stack e-commerce solution with advanced features',
    tags: ['E-Commerce', 'Development'],
  },
  {
    id: 3,
    title: 'SaaS Dashboard',
    slug: 'saas-dashboard',
    description: 'Enterprise-grade dashboard with real-time analytics',
    tags: ['SaaS', 'UI/UX Design'],
  },
];
---



<div class="relative w-full z-20">
  <section id="featured-work-container" class="relative w-full h-[100svh] bg-[#0d141a]">
    
    <div class="absolute inset-0 w-full h-full overflow-hidden">
      {featuredProjects.map((project, index) => (
        <article 
          class={`featured-card absolute inset-0 w-full h-full flex flex-col justify-end p-6 sm:p-12 lg:p-24 will-change-transform ${index === 0 ? 'z-10' : 'z-20'}`}
          style={`z-index: ${10 + index}; background-color: ${index % 2 === 0 ? '#111822' : '#0d141a'};`}
        >
          <!-- Background Asset (Video/Image Placeholder) -->
          <div class="absolute inset-0 w-full h-full overflow-hidden">
            <div class="absolute inset-0 opacity-20" style="background-image: linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 40px 40px;"></div>
            <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent z-10"></div>
            
            <!-- Center Play Button Mock -->
            <div class="absolute inset-0 flex items-center justify-center z-20">
              <div class="w-24 h-24 rounded-full bg-white/10 backdrop-blur-md flex items-center justify-center border border-white/20 text-white/50">
                <svg viewBox="0 0 24 24" fill="currentColor" class="w-12 h-12 ml-2">
                  <path d="M8 5v14l11-7z"/>
                </svg>
              </div>
            </div>
          </div>

          <!-- Content -->
          <div class="relative z-30 w-full max-w-[90rem] mx-auto flex flex-col gap-6 lg:gap-8 xl:px-12" style="margin-bottom: 15vh !important; padding-left: 4vw !important;">
            <div class="flex flex-wrap gap-3">
              {project.tags.map((tag) => (
                <span class="text-white/90 text-sm md:text-base border border-white/20 px-5 py-2 rounded-full backdrop-blur-md bg-white/5">
                  {tag}
                </span>
              ))}
            </div>
            
            <a href={`/work/${project.slug}`} class="group block w-full max-w-max">
              <div class="flex items-center relative">
                <h3 class="text-white text-5xl sm:text-6xl md:text-7xl lg:text-8xl xl:text-[7rem] font-nura uppercase leading-[0.9] tracking-tight transition-transform duration-300 ease-in-out will-change-transform group-hover:translate-x-12 sm:group-hover:translate-x-16 lg:group-hover:translate-x-20">
                  {project.title}
                </h3>
                <!-- Legacy Hover Arrow -->
                <span class="absolute left-0 top-1/2 -translate-y-1/2 overflow-hidden h-10 w-10 sm:h-12 sm:w-12 lg:h-16 lg:w-16">
                  <span class="absolute left-0 top-1/2 -translate-y-1/2 -translate-x-full opacity-0 transition-all duration-300 ease-in-out group-hover:translate-x-0 group-hover:opacity-100 flex items-center justify-center">
                    <svg viewBox="0 0 24 24" role="img" fill="none" class="h-8 w-8 sm:h-10 sm:w-10 lg:h-14 lg:w-14 text-white">
                      <path fill-rule="evenodd" clip-rule="evenodd" d="M1.9999 11.9998C1.9999 12.552 2.44762 12.9997 2.9999 12.9997H18.9757C18.8901 13.148 18.7838 13.2876 18.657 13.4144L12.2931 19.7784C11.9025 20.1689 11.9025 20.8021 12.2931 21.1926C12.6836 21.5831 13.3168 21.5831 13.7073 21.1926L22.1926 12.7073C22.5831 12.3168 22.5831 11.6836 22.1926 11.2931L22.1924 11.293L13.7071 2.80767C13.3166 2.41715 12.6834 2.41715 12.2929 2.80767C11.9024 3.1982 11.9024 3.83136 12.2929 4.22189L18.657 10.586C18.7836 10.7126 18.8896 10.8518 18.9752 10.9998H2.9999C2.44762 10.9997 1.9999 11.4475 1.9999 11.9998Z" fill="currentColor" />
                    </svg>
                  </span>
                </span>
              </div>
            </a>
          </div>

        </article>
      ))}
    </div>
  </section>
</div>

<!-- View All Button below the pinned stack -->
<section class="w-full bg-[#0d141a] flex justify-center py-20 lg:py-32 relative z-[90]">
  <a href="/work" class="work-btn-view-all inline-flex items-center gap-4 px-10 py-5 rounded-full bg-white text-black font-bold uppercase tracking-wider hover:bg-accent-orange hover:text-white transition-all duration-300">
    <span>View All Projects</span>
    <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M5 12h14M12 5l7 7-7 7"/>
    </svg>
  </a>
</section>

<style>
  /* Local overrides for the wrapper */
  #featured-work-container {
    box-shadow: 0 -20px 50px rgba(0,0,0,0.1);
  }

  .work-btn-view-all {
    display: inline-block;
    position: relative;
    overflow: hidden;
  }

  :global(.work-blob-view-all) {
    z-index: 0;
    position: absolute;
    width: 2px;
    height: 2px;
    margin-left: 0;
    margin-top: 0;
    background: #ff4500;
    border-radius: 50%;
    transition: transform 0.45s ease-in-out;
    transform: scale(1);
  }

  :global(.work-expand-view-all) {
    transform: scale(300);
  }
  
  .work-btn-view-all span, .work-btn-view-all svg {
    position: relative;
    z-index: 10;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    initWorkButton();
  });

  document.addEventListener('astro:page-load', () => {
    initWorkButton();
  });

  function initWorkButton() {
    const btn = document.querySelector('.work-btn-view-all') as HTMLElement;
    if (!btn) return;

    btn.addEventListener('mouseenter', function(this: HTMLElement, e: MouseEvent) {
      const existing = this.querySelector('.work-blob-view-all');
      if (existing) existing.remove();

      const rect = this.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      const blob = document.createElement('div');
      blob.className = 'work-blob-view-all';
      blob.style.left = x + 'px';
      blob.style.top = y + 'px';
      this.appendChild(blob);
      
      setTimeout(function() {
        blob.classList.add('work-expand-view-all');
      }, 20);
    });

    btn.addEventListener('mouseleave', function(this: HTMLElement, e: MouseEvent) {
      const rect = this.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      const blobs = this.querySelectorAll('.work-blob-view-all');
      blobs.forEach(function(blob: Element) {
        const htmlBlob = blob as HTMLElement;
        htmlBlob.style.left = x + 'px';
        htmlBlob.style.top = y + 'px';
        blob.classList.remove('work-expand-view-all');
        setTimeout(function() {
          blob.remove();
        }, 450);
      });
    });
  }
</script>
